{%- assign product = all_products[section.settings.featured_product] -%}

{% style %}
  .luma-featured {
    padding: 6rem 1.5rem;
    background-color: #FAFAFA;
    scroll-margin-top: 5rem;
  }
  @media (min-width: 768px) {
    .luma-featured { padding: 8rem 2rem; }
  }
  .luma-featured__container {
    max-width: 72rem;
    margin: 0 auto;
  }
  .luma-featured__header {
    display: flex;
    justify-content: space-between;
    align-items: flex-end;
    margin-bottom: 3rem;
  }
  .luma-featured__heading {
    font-family: 'Playfair Display', serif;
    font-size: 2.25rem;
    color: #1A1A1A;
  }
  @media (min-width: 768px) {
    .luma-featured__heading { font-size: 3rem; }
  }
  .luma-featured__eyebrow {
    font-family: 'Inter', sans-serif;
    font-size: 0.75rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.25em;
    color: rgba(26,26,26,0.5);
    display: none;
  }
  @media (min-width: 768px) {
    .luma-featured__eyebrow { display: block; }
  }

  .luma-featured__card {
    background-color: #FFFFFF;
    border-radius: 2rem;
    border: 1px solid #E5E5E5;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    transition: box-shadow 0.5s ease;
  }
  .luma-featured__card:hover {
    box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
  }
  @media (min-width: 768px) {
    .luma-featured__card { flex-direction: row; }
  }

  .luma-featured__media {
    width: 100%;
    position: relative;
    background: {{ section.settings.image_gradient | default: 'linear-gradient(135deg, #E0EDF8 0%, #E6DEF2 100%)' }};
    border-right: 1px solid #E5E5E5;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
  }
  @media (min-width: 768px) {
    .luma-featured__media { width: 41.666667%; }
  }
  .luma-featured__texture {
    position: absolute;
    inset: 0;
    background-image: url('https://www.transparenttextures.com/patterns/cubes.png');
    opacity: 0.1;
    mix-blend-mode: overlay;
  }
  .luma-featured__badge {
    position: absolute;
    top: 1.5rem;
    left: 1.5rem;
    z-index: 20;
    background-color: #1e3a8a;
    color: #FFFFFF;
    font-size: 0.625rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    padding: 0.375rem 0.75rem;
    border-radius: 9999px;
    box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
  }
  .luma-featured__img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    mix-blend-mode: multiply;
    opacity: 0.9;
    transition: transform 0.7s ease;
    position: relative;
    z-index: 10;
  }
  .luma-featured__card:hover .luma-featured__img {
    transform: scale(1.05);
  }

  .luma-featured__content {
    width: 100%;
    padding: 2rem;
    display: flex;
    flex-direction: column;
    justify-content: center;
  }
  @media (min-width: 768px) {
    .luma-featured__content {
      width: 58.333333%;
      padding: 3rem;
    }
  }

  .luma-featured__rating {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    color: #D4A340;
    font-size: 0.75rem;
    margin-bottom: 1rem;
  }
  .luma-featured__rating-count {
    color: rgba(26,26,26,0.5);
    margin-left: 0.25rem;
    font-weight: 500;
  }

  .luma-featured__title {
    font-family: 'Playfair Display', serif;
    font-size: 2.25rem;
    color: #1A1A1A;
    margin-bottom: 0.25rem;
  }
  @media (min-width: 768px) {
    .luma-featured__title { font-size: 3rem; }
  }
  .luma-featured__title a {
    text-decoration: none;
    color: inherit;
    transition: color 0.3s ease;
  }
  .luma-featured__title a:hover { color: #D4A340; }

  .luma-featured__volume {
    font-family: 'Inter', sans-serif;
    font-size: 0.75rem;
    color: rgba(26,26,26,0.5);
    text-transform: uppercase;
    letter-spacing: 0.25em;
    font-weight: 700;
    margin-bottom: 1.5rem;
  }

  .luma-featured__desc {
    font-family: 'Inter', sans-serif;
    font-size: 1rem;
    color: rgba(26,26,26,0.7);
    margin-bottom: 2rem;
    font-weight: 300;
    line-height: 1.625;
  }

  .luma-featured__props {
    display: grid;
    grid-template-columns: repeat(2, minmax(0, 1fr));
    row-gap: 0.75rem;
    column-gap: 1.5rem;
    margin-bottom: 2.5rem;
    font-size: 0.875rem;
    color: rgba(26,26,26,0.8);
    font-weight: 500;
  }
  .luma-featured__prop {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .luma-featured__footer {
    margin-top: auto;
    padding-top: 1.5rem;
    border-top: 1px solid #E5E5E5;
    display: flex;
    align-items: center;
    justify-content: space-between;
  }
  .luma-featured__price {
    font-family: 'Playfair Display', serif;
    font-size: 1.5rem;
    color: #1A1A1A;
  }
  .luma-featured__actions {
    display: flex;
    gap: 0.75rem;
  }
  .luma-featured__btn-view {
    display: none;
    align-items: center;
    justify-content: center;
    border: 1px solid #1A1A1A;
    color: #1A1A1A;
    font-family: 'Inter', sans-serif;
    font-size: 0.75rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    padding: 0.75rem 1.5rem;
    border-radius: 9999px;
    text-decoration: none;
    transition: all 0.3s ease;
  }
  @media (min-width: 640px) {
    .luma-featured__btn-view { display: flex; }
  }
  .luma-featured__btn-view:hover { background-color: #FAFAFA; }

  .luma-featured__btn-add {
    background-color: #1A1A1A;
    color: #FFFFFF;
    font-family: 'Inter', sans-serif;
    font-size: 0.75rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    padding: 0.75rem 2rem;
    border-radius: 9999px;
    border: none;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
  }
  .luma-featured__btn-add:hover { background-color: #D4A340; }
  .luma-featured__btn-add i { font-size: 1rem; }
{% endstyle %}

<section id="solution" class="luma-featured">
  <div class="luma-featured__container">
    <div class="luma-featured__header">
      <h2 class="luma-featured__heading">{{ section.settings.heading }}</h2>
      <span class="luma-featured__eyebrow">{{ section.settings.eyebrow }}</span>
    </div>

    <div class="luma-featured__card">
      <div class="luma-featured__media">
        <div class="luma-featured__texture"></div>
        {% if section.settings.badge != blank %}
          <div class="luma-featured__badge">{{ section.settings.badge }}</div>
        {% endif %}

        {% if product != blank %}
          {{
            product.featured_image
            | image_url: width: 1000
            | image_tag: class: 'luma-featured__img', loading: 'lazy'
          }}
        {% else %}
          <img
            src="{{ section.settings.fallback_image | default: 'https://images.unsplash.com/photo-1620916566398-39f1143ab7be?q=80&w=1000&auto=format&fit=crop' }}"
            alt="Featured Solution"
            class="luma-featured__img"
            loading="lazy"
          >
        {% endif %}
      </div>

      <div class="luma-featured__content">
        <div class="luma-featured__rating">
          <i class="ph-fill ph-star"></i><i class="ph-fill ph-star"></i><i class="ph-fill ph-star"></i
          ><i class="ph-fill ph-star"></i><i class="ph-fill ph-star"></i>
          <span class="luma-featured__rating-count"
            >({{ section.settings.review_count | default: '128' }} Reviews)</span
          >
        </div>

        <h3 class="luma-featured__title">
          <a href="{{ product.url | default: '#' }}">{{ product.title | default: section.settings.fallback_title }}</a>
        </h3>
        <p class="luma-featured__volume">{{ section.settings.volume_text }}</p>

        <p class="luma-featured__desc">
          {{ product.description | strip_html | truncatewords: 30 | default: section.settings.fallback_desc }}
        </p>

        <div class="luma-featured__props">
          {% for block in section.blocks %}
            <div class="luma-featured__prop">
              <i class="ph-fill ph-check-circle" style="color: #D4A340; font-size: 1.125rem;"></i>
              {{ block.settings.prop_text }}
            </div>
          {% endfor %}
        </div>

        <div class="luma-featured__footer">
          <span class="luma-featured__price">{{ product.price | money | default: '$48.00' }}</span>
          <div class="luma-featured__actions">
            <a href="{{ product.url | default: '#' }}" class="luma-featured__btn-view">View Details</a>
            {% form 'product', product %}
              <input type="hidden" name="id" value="{{ product.variants.first.id }}">
              <button type="submit" class="luma-featured__btn-add">
                Add to Cart <i class="ph-bold ph-shopping-bag"></i>
              </button>
            {% endform %}
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Collection Featured Item",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "The Primary Solution"
    },
    {
      "type": "text",
      "id": "eyebrow",
      "label": "Eyebrow Text",
      "default": "Targeted Treatment"
    },
    {
      "type": "product",
      "id": "featured_product",
      "label": "Selected Product"
    },
    {
      "type": "text",
      "id": "image_gradient",
      "label": "Image Background Gradient",
      "default": "linear-gradient(135deg, #E0EDF8 0%, #E6DEF2 100%)"
    },
    {
      "type": "text",
      "id": "badge",
      "label": "Badge Text",
      "default": "Best Seller"
    },
    {
      "type": "text",
      "id": "volume_text",
      "label": "Volume/Size Text",
      "default": "50 ml / 1.7 fl oz"
    },
    {
      "type": "text",
      "id": "review_count",
      "label": "Review Count",
      "default": "128"
    },
    {
      "type": "text",
      "id": "fallback_title",
      "label": "Fallback Title",
      "default": "Barrier Renew Moisturizer"
    },
    {
      "type": "textarea",
      "id": "fallback_desc",
      "label": "Fallback Description",
      "default": "Our clinical masterpiece. A liquid-crystal emulsion delivering physiological lipids..."
    }
  ],
  "blocks": [
    {
      "type": "value_prop",
      "name": "Value Proposition",
      "limit": 6,
      "settings": [
        {
          "type": "text",
          "id": "prop_text",
          "label": "Text"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Collection Featured Item",
      "blocks": [
        { "type": "value_prop", "settings": { "prop_text": "3:1:1 Ceramide Ratio" } },
        { "type": "value_prop", "settings": { "prop_text": "Liquid-Crystal Delivery" } },
        { "type": "value_prop", "settings": { "prop_text": "Contains Matrixyl 3000â„¢" } },
        { "type": "value_prop", "settings": { "prop_text": "5% Niacinamide" } }
      ]
    }
  ]
}
{% endschema %}
